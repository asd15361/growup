# Worklog - 2026-02-20

## èƒŒæ™¯
- ç›®æ ‡ï¼šä¿®å¤ã€Œæ³¨å†Œ/ç™»å½•/èŠå¤©å¯ç”¨æ€§ã€ã€ç™½å±å¡ä½ã€ç½‘ç»œé“¾è·¯ä¸ç¨³å®šã€å‰åç«¯ä¸€è‡´æ€§ä¸å®‰å…¨é—®é¢˜ã€‚
- å½“å‰ä¸»é“¾è·¯ï¼šSealos API + Sealos PocketBaseã€‚

## å·²å®Œæˆï¼ˆä»£ç ï¼‰
1. å‰ç«¯ç½‘ç»œä¸ç™»å½•æµç¨‹ç¨³æ€ä¿®å¤
- æ–‡ä»¶ï¼š`src/lib/api.ts`
- å˜æ›´ï¼š
  - é»˜è®¤ API å›é€€åœ°å€å›ºå®šåˆ° Sealosï¼š`https://growup-api-3c44t6.cloud.sealos.io`
  - é”™è¯¯æç¤ºä¸­æ–‡åŒ–ä¸ç»Ÿä¸€æ˜ å°„
  - èŠå¤©è¯·æ±‚è¶…æ—¶æå‡åˆ° `70000ms`
  - å¤šå…¥å£å¤±è´¥æ—¶ç»™å‡ºèšåˆé”™è¯¯ä¿¡æ¯

2. ç™»å½•ä¸å†è¢«â€œäº‘åŒæ­¥å¤±è´¥â€é˜»å¡
- æ–‡ä»¶ï¼š`App.tsx`
- å˜æ›´ï¼š
  - `loadCloudData` æ”¹ä¸º `Promise.allSettled`
  - æ³¨å†Œ/ç™»å½•åï¼šäº‘åŒæ­¥å¤±è´¥åªæç¤ºï¼Œä¸æ‹¦æˆªè¿›å…¥åº”ç”¨

3. å¯åŠ¨ç™½å±å…œåº•
- æ–‡ä»¶ï¼š`App.tsx`
- å˜æ›´ï¼š
  - å­—ä½“åŠ è½½å¤±è´¥ä¸å†é˜»å¡
  - å¯åŠ¨è¶…æ—¶ 12 ç§’è‡ªåŠ¨æ”¾è¡Œï¼Œé¿å…æ— é™è½¬åœˆ

4. å¤ç›˜è‡ªåŠ¨æ›´æ–°é€»è¾‘ä¿®å¤
- æ–‡ä»¶ï¼š`App.tsx`
- é—®é¢˜ï¼šåŸé€»è¾‘åŒä¸€å¤©åªè·‘ä¸€æ¬¡å¤ç›˜ï¼Œåç»­èŠå¤©ä¸åˆ·æ–°
- å˜æ›´ï¼š
  - æ”¹ä¸ºæŒ‰â€œæœ€æ–°ç”¨æˆ·æ¶ˆæ¯â€è§¦å‘å¤ç›˜
  - å¢åŠ  60 ç§’èŠ‚æµï¼Œé¿å…é¢‘ç¹åˆ·å†™

5. åç«¯å®‰å…¨ä¿®å¤ï¼ˆæœªç™»å½•ç¦æ­¢èŠå¤©ï¼‰
- æ–‡ä»¶ï¼š`server/index.js`
- å˜æ›´ï¼š
  - `/api/chat` å¼ºåˆ¶ `Bearer token`
  - æ—  token æˆ– token æ— æ•ˆè¿”å› `401`
  - æŒä¹…åŒ–æ—¶å¤ç”¨å·²é‰´æƒä¸Šä¸‹æ–‡ï¼Œå‡å°‘é‡å¤ auth è°ƒç”¨
- Git æäº¤ï¼š`bf18d83`
- å·²æ¨é€ï¼š`origin/master`

6. æ¸…ç†æ­»ä»£ç ä¸å™ªéŸ³é…ç½®
- åˆ é™¤æ–‡ä»¶ï¼š
  - `src/lib/assistant.ts`
  - `src/lib/storage.ts`
- æ–‡ä»¶ï¼š`src/lib/memoryEngine.ts`
  - åˆ é™¤æœªä½¿ç”¨çš„ `upsertWeeklyDigest` ç›¸å…³é€»è¾‘
- æ–‡ä»¶ï¼š`eas.json`ã€`.env.example`
  - åˆ é™¤æœªä½¿ç”¨é…ç½®ï¼š`EXPO_PUBLIC_ENABLE_DEMO_LOGIN`
- æ–‡ä»¶ï¼š`.gitignore`
  - å¢åŠ  `*.apk`ï¼Œé¿å…å®‰è£…åŒ…è¯¯å…¥åº“

7. æ–‡æ¡£é‡å†™ä¸å»æ•
- æ–‡ä»¶ï¼š`README.md`
  - é‡å†™ä¸ºå½“å‰çœŸå®æ¶æ„ä¸å¯åŠ¨æ–¹å¼
- æ–‡ä»¶ï¼š`docs/pocketbase-sealos.md`
  - åˆ é™¤æ˜æ–‡å‡­æ®ï¼Œæ”¹ä¸º Secrets Policy

## å·²å®Œæˆï¼ˆéªŒè¯ï¼‰
1. ä»£ç æ£€æŸ¥
- `npx tsc --noEmit` é€šè¿‡
- `npx expo-doctor` é€šè¿‡ï¼ˆ17/17ï¼‰
- `node --check server/index.js` é€šè¿‡

2. API çƒŸæµ‹ï¼ˆæœ¬åœ°å¯åŠ¨ serverï¼‰
- `GET /api/health` -> `200`
- `POST /api/auth/register` -> `200`
- `POST /api/auth/login` -> `200`
- `POST /api/chat`ï¼ˆæ—  tokenï¼‰-> `401`
- `POST /api/chat`ï¼ˆæœ‰ tokenï¼‰-> `200`

3. OTA å‘å¸ƒè®°å½•ï¼ˆpreviewï¼‰
- `a2debbb9-86b5-4f77-8e58-84d5a115c4f8`
- `f4185ed5-d5b5-4c82-bca0-16f4f8aa4223`
- `1de72126-5bc1-4240-a9fa-3fb1b79ab83a`
- `87fbec5d-b9e6-42c7-a757-214784e796c2`

## å½“å‰é˜»å¡
1. Sealos çº¿ä¸Šåç«¯è¿˜åœ¨æ—§ç‰ˆæœ¬ï¼ˆå·²è§£é™¤ï¼‰
- ç°è±¡ï¼šçº¿ä¸Š `POST /api/chat`ï¼ˆæ—  tokenï¼‰ä»è¿”å› `200` æˆ– `429`ï¼Œæœªä½“ç°æ–°é€»è¾‘ `401`
- åŸå› ï¼š`Restart` åªé‡å¯å®¹å™¨ï¼Œä¸ä¼šé‡æ–°æ‹‰å– Git æœ€æ–°ä»£ç 
- æ­£ç¡®åŠ¨ä½œï¼š`Redeploy / Rebuild from Git`ï¼ˆåˆ†æ”¯ `master`ï¼‰
- è§£é™¤ç»“æœï¼ˆ2026-02-20ï¼‰ï¼š`POST /api/chat`ï¼ˆæ—  tokenï¼‰å·²è¿”å› `401`

2. æµè§ˆå™¨è‡ªåŠ¨åŒ–é€šé“ä¸´æ—¶ä¸å¯ç”¨
- MCP Chrome å·¥å…·æŠ¥é”™ï¼š`Transport closed`
- å·²å¤„ç†ï¼šæ¸…ç†å†²çªè°ƒè¯• Chrome è¿›ç¨‹ï¼ˆ`mcp-chrome` / `chrome-cdp`ï¼‰
- å¾…ä½ é‡å¼€åæ¢å¤æ¥ç®¡å†è¯•

## ä½ é‡å¼€åçš„ä¸€æ­¥åŠ¨ä½œï¼ˆå·²å®Œæˆï¼‰
1. åœ¨ Sealos å¯¹ `growup-api-3c44t6` æ‰§è¡Œ `Redeploy`ï¼ˆä¸æ˜¯ `Restart`ï¼‰ã€‚
2. é€šçŸ¥æˆ‘â€œå·²éƒ¨ç½²â€ã€‚
3. æˆ‘ä¼šç«‹å³éªŒæ”¶ï¼š
   - é¢„æœŸï¼š`POST /api/chat`ï¼ˆæ—  tokenï¼‰è¿”å› `401`ã€‚

## å¤‡æ³¨
- ç›®å‰ `npm audit` ä»æœ‰é«˜å±ä¾èµ–é¡¹ï¼Œä¸»è¦æ¥è‡ª Expo/RN ä¸Šæ¸¸ä¾èµ–é“¾ï¼Œéœ€è¦å¤§ç‰ˆæœ¬å‡çº§å•ç‹¬æ¨è¿›ï¼Œæš‚ä¸å»ºè®®åœ¨å½“å‰é˜¶æ®µå¼ºè¡Œå‡çº§ã€‚

## æœ¬æ¬¡è¿½åŠ è¿›å±•ï¼ˆ2026-02-20ï¼‰
1. çº¿ä¸ŠéªŒæ”¶ï¼ˆSealos APIï¼‰
- `GET /api/health` -> `200`
- `POST /api/chat`ï¼ˆæ—  tokenï¼‰-> `401`
- ç»“è®ºï¼š`/api/chat` çš„â€œæœªç™»å½•ç¦æ­¢è®¿é—®â€ç­–ç•¥å·²åœ¨çº¿ä¸Šç”Ÿæ•ˆã€‚

2. æ–°å¢ä¸€é”®çƒŸæµ‹è„šæœ¬
- æ–°å¢ï¼š`scripts/verify-sealos-api.js`
- æ–°å¢ npm è„šæœ¬ï¼š`npm run smoke:sealos`
- è¡Œä¸ºï¼šè‡ªåŠ¨æ£€æŸ¥
  - `GET /api/health` æ˜¯å¦å¯ç”¨
  - `POST /api/chat`ï¼ˆæ—  tokenï¼‰æ˜¯å¦è¿”å› `401`

3. Sealos æ§åˆ¶å°å˜æ›´å‘å¸ƒï¼ˆå·²æ‰§è¡Œï¼‰
- æ—¶é—´ï¼š`2026-02-20 12:56:01`
- æ“ä½œï¼šåœ¨ `growup-api-3c44t6` çš„â€œæ›´æ–°åº”ç”¨â€é¡µç‚¹å‡» `å˜æ›´` å¹¶ç¡®è®¤å‘å¸ƒã€‚
- è§‚å¯Ÿï¼šå‡ºç°æ–° Podï¼ˆ`growup-api-3c44t6-c4bb56f95-4cgld`ï¼‰è¿›å…¥æ»šåŠ¨æ›´æ–°ã€‚
- å‘å¸ƒåéªŒæ”¶ï¼š`npm run smoke:sealos` é€šè¿‡ï¼ˆ`health=200`ï¼Œ`chat æ—  token=401`ï¼‰ã€‚

4. æ‰“åŒ…è®°å½•ï¼ˆå¿…é¡»è®°å½•ï¼‰
- æ—¶é—´ï¼š`2026-02-20 13:18`ï¼ˆé¦–æ¬¡æœ¬åœ° release æ‰“åŒ…ï¼Œåç¡®è®¤ç‰ˆæœ¬çº¿é”™è¯¯ï¼‰
- é”™è¯¯ï¼šå½“æ—¶ç‰ˆæœ¬ä»ä¸º `1.0.0`ï¼Œä¸ç¬¦åˆå½“å‰ç‰ˆæœ¬çº¿ `1.18`ã€‚
- ä¿®æ­£åŠ¨ä½œï¼š
  - `app.json` ç‰ˆæœ¬æ”¹ä¸º `1.18.0`
  - `android.versionCode=118`
  - `ios.buildNumber=118`
  - `package.json` åŒæ­¥ä¸º `1.18.0`
- äº§ç‰©ä½ç½®ï¼ˆé‡æ‰“åç”Ÿæ•ˆï¼‰ï¼š
  - `android/app/build/outputs/apk/release/app-release.apk`
  - `app-release.apk`

5. äºŒæ¬¡é‡æ‰“åŒ…ä¸ç‰ˆæœ¬æ ¸éªŒï¼ˆæœ€ç»ˆå¯å‘ç‰ˆåŒ…ï¼‰
- æ—¶é—´ï¼š`2026-02-20 15:37:41`
- é¢å¤–ä¿®æ­£ï¼š`android/app/build.gradle` ä¸­ `versionCode/versionName` åŒæ­¥æ”¹ä¸º `118/1.18.0`ï¼ˆAPK å®é™…è¯»å–æ¥æºï¼‰ã€‚
- æ‰“åŒ…å‘½ä»¤ï¼š`cd android && .\gradlew.bat assembleRelease`
- APK å†…éƒ¨ç‰ˆæœ¬éªŒæ”¶ï¼ˆ`aapt dump badging app-release.apk`ï¼‰ï¼š
  - `package: name='com.tianboasd.growup' versionCode='118' versionName='1.18.0'`
- æœ€ç»ˆäº§ç‰©ï¼š
  - `android/app/build/outputs/apk/release/app-release.apk`ï¼ˆ`70093380` bytesï¼Œ`2026-02-20 15:37:41`ï¼‰
  - `app-release.apk`ï¼ˆ`70093380` bytesï¼Œ`2026-02-20 15:37:41`ï¼‰
- SHA256ï¼š`47D9F4E7D1285AF47D352E3061356D2A77201694BBF72DD09E96A1C4CA4157F5`

6. çº¿ä¸Šè¡¥å……éªŒæ”¶ï¼ˆinternal recap prompt æ‹¦æˆªï¼‰
- æ—¶é—´ï¼š`2026-02-20 15:45`ï¼ˆæœ¬æœºè„šæœ¬ä¸´æ—¶æ³¨å†Œæ–°è´¦å·åç›´è¿ Sealos APIï¼‰
- ç”¨ä¾‹ï¼šæºå¸¦æœ‰æ•ˆ `Bearer token` è°ƒç”¨ `POST /api/chat`ï¼Œæ¶ˆæ¯å†…å®¹å‘½ä¸­ internal recap å…³é”®è¯ï¼ˆ`è¯·æ ¹æ®ä»¥ä¸‹èŠå¤©è®°å½•ç”Ÿæˆ` + `ä»…è¿”å› JSON` + `"summary"` + `"important"` + `"todo"`ï¼‰ã€‚
- é¢„æœŸï¼š`400`ï¼Œé”™è¯¯ `internal recap prompt is not allowed on chat endpoint`
- å®é™…ï¼š`400`ï¼Œé”™è¯¯ `internal recap prompt is not allowed on chat endpoint`
- ç»“è®ºï¼šSealos çº¿ä¸Šåç«¯å·²ç”Ÿæ•ˆè¯¥æ‹¦æˆªé€»è¾‘ã€‚
- åŒæ­¥åŠ¨ä½œï¼š`scripts/verify-sealos-api.js` å·²å‡çº§ä¸ºåŒé‡æ ¡éªŒï¼ˆ`401 no token` + `400 internal recap guard`ï¼‰ï¼Œåç»­ä¸€é”®çƒŸæµ‹å¯ç›´æ¥è¯†åˆ«è¯¥ç­–ç•¥æ˜¯å¦åœ¨çº¿ã€‚

7. æ‰“åŒ…æ–‡ä»¶åè§„åˆ™å›ºåŒ–ï¼ˆé˜²æ¼ï¼‰
- æ–°å¢è„šæœ¬ï¼š`scripts/build-android-release.js`
- æ–°å¢å‘½ä»¤ï¼š`npm run build:apk`
- è§„åˆ™ï¼šæ¯æ¬¡æ‰“åŒ…åè‡ªåŠ¨è¾“å‡ºç‰ˆæœ¬åŒ–æ–‡ä»¶å `app-release-v<package.json.version>.apk`ï¼Œå½“å‰ç¤ºä¾‹ä¸º `app-release-v1.18.0.apk`ã€‚
- å…¼å®¹ï¼šåŒæ—¶ä¿ç•™ `app-release.apk`ï¼ˆç”¨äºè€æµç¨‹ä¸æ”¹å‘½ä»¤ç›´æ¥å®‰è£…ï¼‰ã€‚

8. ç‰ˆæœ¬åŒ–å‘½åæ‰“åŒ…æ‰§è¡Œè®°å½•
- æ‰§è¡Œæ—¶é—´ï¼š`2026-02-20 16:00:12`
- æ‰§è¡Œå‘½ä»¤ï¼š`npm run build:apk`
- ç‰ˆæœ¬æ–‡ä»¶ï¼š
  - `app-release-v1.18.0.apk`ï¼ˆ`70093380` bytesï¼Œ`2026-02-20 15:37:41`ï¼‰
  - `app-release.apk`ï¼ˆ`70093380` bytesï¼Œ`2026-02-20 15:37:41`ï¼‰
- è¯´æ˜ï¼šåŒç‰ˆæœ¬ä¸”ä»£ç æœªå˜åŒ–æ—¶ï¼ŒGradle å¯èƒ½å¤ç”¨æ—¢æœ‰ release äº§ç‰©ï¼Œå› æ­¤æ–‡ä»¶ä¿®æ”¹æ—¶é—´å¯ä¸æœ¬æ¬¡æ‰§è¡Œæ—¶é—´ä¸åŒã€‚

9. V2 æ¶æ„ç¬¬ä¸€é˜¶æ®µå¯åŠ¨ï¼ˆè®°å¿†å±‚è§£è€¦ï¼‰
- åç«¯æ–‡ä»¶ï¼š`server/index.js`
- å˜æ›´ï¼š
  - æ–°å¢ `POCKETBASE_MEMORIES_COLLECTION`ï¼ˆé»˜è®¤ `memories`ï¼‰
  - `GET/POST /api/identity` ä¸ `GET/POST /api/state` ä¼˜å…ˆè¯»å†™ `memories`ï¼Œå¹¶ä¿ç•™æ—§ `chat_messages(system)` è‡ªåŠ¨å›é€€ï¼Œç¡®ä¿ç°ç½‘å…¼å®¹
  - æ–°å¢ `GET /api/memories`ï¼ˆç”¨æˆ·å¯æ‹‰å–è‡ªå·±çš„è®°å¿†è®°å½•ï¼‰
  - `/api/health` å¢åŠ  `pocketbase.memoriesCollection` è¿”å›å­—æ®µ
- ç¯å¢ƒå˜é‡ï¼š`.env.example` æ–°å¢ `POCKETBASE_MEMORIES_COLLECTION=memories`
- æ–‡æ¡£ï¼š
  - `README.md` å¢åŠ  `memories` è¯´æ˜ä¸ç¯å¢ƒå˜é‡
  - `docs/pocketbase-sealos.md` å¢åŠ  `memories` collection çº¦æŸ

10. æ‰§è¡Œæ¸…å•å›ºåŒ–ï¼ˆé˜²å¿˜ï¼‰
- æ–°å¢ï¼š`docs/v2-rollout-checklist.md`
- ä½œç”¨ï¼šæŠŠâ€œæ¯æ¬¡å‘å¸ƒå¿…é¡»åšçš„çº¿ä¸ŠéªŒæ”¶ã€è¿ç§»éªŒæ”¶ã€æ–‡æ¡£å›å¡«â€å›ºåŒ–ä¸ºå›ºå®šæµç¨‹ã€‚

11. V2 Phase A é¦–æ¬¡ä¸Šçº¿éªŒæ”¶ï¼ˆSealosï¼‰
- Git æäº¤ï¼š`66331b6`
- æ¨é€ï¼š`origin/master`
- ä½ åœ¨ Sealos å¯¹ `growup-api-3c44t6` æ‰§è¡Œäº† `å˜æ›´`ï¼ˆåŒæ—¶ä¸‹è°ƒäº† CPU/å†…å­˜ï¼‰ã€‚
- éªŒæ”¶è¿‡ç¨‹ï¼š
  - åˆå§‹å‘½ä¸­æ—§ Podï¼š`GET /api/memories` = `404`ï¼Œ`/api/health` æ—  `memoriesCollection`
  - æ»šåŠ¨æ›´æ–°åç¨³å®šé€šè¿‡ï¼ˆè¿ç»­ 8 æ¬¡ï¼‰ï¼š
    - `GET /api/health` = `200`ï¼Œä¸” `pocketbase.memoriesCollection=memories`
    - `GET /api/memories` = `200`
  - `npm run smoke:sealos` ç»§ç»­é€šè¿‡ï¼ˆ`health=200`ï¼Œ`chat no token=401`ï¼Œ`internal recap with token=400`ï¼‰
- å…³é”®å‘ç°ï¼š
  - ç›®å‰ `memories` æ¥å£å¯ç”¨ï¼Œä½†å†™å…¥ identity åè¯»å–ç»“æœä¸ºâ€œæ—  id çš„å›é€€ç»“æ„â€ï¼Œè¯´æ˜çº¿ä¸Š PocketBase å°šæœªåˆ›å»ºå¯ç”¨çš„ `memories` collectionï¼ˆå½“å‰ç”±æ—§ `chat_messages(system)` å…¼å®¹å›é€€å…œåº•ï¼‰ã€‚
- å¾…åŠï¼š
  - åœ¨ PocketBase æ–°å»º `memories` collectionï¼ˆè§ `docs/pocketbase-sealos.md`ï¼‰ã€‚
  - åˆ›å»ºåå†åšä¸€æ¬¡å†™å…¥/è¯»å–éªŒæ”¶ï¼Œç¡®è®¤è¿”å›å¸¦ `id` çš„çœŸå® memories è®°å½•ã€‚

## 2026-02-20 Phase A Completion Addendum (Sealos + Memories)
- 2026-02-20: Created PocketBase collection `memories` on Sealos runtime.
- Collection fields:
  - `user` (relation -> `users`, single, required)
  - `kind` (text, required)
  - `content` (text, required)
- API rules configured for all List/View/Create/Update/Delete:
  - `@request.auth.id != "" && user = @request.auth.id`
- Backend fix deployed for first-write memory path:
  - commit `4a61b76` (`fix(memory): tolerate generic filter errors when probing memory schema`)
- Sealos operation executed:
  - restarted app `growup-api-3c44t6` to pull latest `master` via startup `git clone --depth=1 ...`
- Online acceptance evidence:
  - `npm run smoke:sealos` passed
  - 8/8 consecutive checks passed for `POST /api/identity` + `GET /api/memories`
  - `GET /api/memories` returns real records with non-empty `id` (not fallback-only structure)

## 2026-02-20 Phase B.1 Start (Vector DB integration, no graph)

- Decision: implement vector memory retrieval first; graph DB postponed.
- Backend changes in `server/index.js`:
  - Added Qdrant config (`VECTOR_ENABLED`, `QDRANT_URL`, `QDRANT_API_KEY`, `QDRANT_COLLECTION`, `VECTOR_*`).
  - Added local hash embedding generator (no extra dependency) for stable first rollout.
  - Added Qdrant collection auto-create/check, with temporary backoff on failures.
  - Added async upsert of user chat messages to Qdrant after persistence.
  - Added vector retrieval in `/api/chat`, merged into `relevantMemories` before model call.
  - Added vector status fields in `/api/health`.
- Compatibility strategy:
  - If Qdrant is not configured or unavailable, chat flow degrades to existing non-vector path automatically.
- Files updated:
  - `server/index.js`
  - `.env.example`
  - `README.md`
  - `docs/v2-rollout-checklist.md`

## 2026-02-20 Phase B.1 Runtime Activation (Sealos Qdrant, No Graph)
- Qdrant app created in Sealos App Launchpad:
  - app name: `qdrant`
  - image: `qdrant/qdrant`
  - port: `6333`
  - internal URL: `http://qdrant-rgvqyrdzvlow.ns-i0nobo1l:6333`
- API app `growup-api-3c44t6` was updated via `±ä¸ü`.
- Because Sealos env modal did not persist new keys reliably in this session, runtime command parameters were updated to inject vector config at startup:
  - `QDRANT_URL=http://qdrant-rgvqyrdzvlow.ns-i0nobo1l:6333`
  - `QDRANT_COLLECTION=growup_memories`
- Rollout evidence (2026-02-20 around 20:01 local):
  - New pod startup log: `[growup-server] vector=enabled qdrant=configured collection=growup_memories dim=384 topK=6`
  - Old pod was drained; final pod list returned to 1 running pod.
- Online acceptance after rollout:
  - `GET /api/health`: `vector.enabled=true`, `vector.configured=true` (6/6 consecutive checks)
  - `npm run smoke:sealos`: pass
  - `REQUIRE_VECTOR=true npm run smoke:sealos`: pass

## 2026-02-20 Hotfix: No-Vector Daily Recap Context in Chat
- Purpose: allow chat to read daily recap content even when vector retrieval is disabled/unavailable.
- Change: `/api/chat` now loads user `state.recaps` and injects recent day recap summary/highlight/action into `relevantMemories` before model call.
- Scope: backend-only; existing installed app can use it immediately without client upgrade.

## 2026-02-20 Hotfix Deployment Addendum (Daily Recap Fallback)
- Git:
  - pushed `de4aa6c` to `origin/master`
  - change: `/api/chat` now reads `state.recaps` (day) and injects recap summary/highlight/action into `relevantMemories`
- Sealos rollout:
  - app: `growup-api-3c44t6`
  - operation: clicked `±ä¸ü` and confirmed update dialog
  - runtime evidence: new pod `growup-api-3c44t6-75968b9759-5mwpl` became the only running pod
- Online acceptance (post-rollout):
  - `npm run smoke:sealos` pass
  - `GET /api/health` = 200
  - `POST /api/chat` no token = 401
  - internal recap guard = 400 (with token)
- Note:
  - Sealos edit UI intermittently routes to a wrong default form (`hello-world`), so runtime toggle `VECTOR_ENABLED=false` was not applied in this pass.
  - Current runtime remains `vector.enabled=true`, but the recap fallback hotfix is additive and already deployed.
