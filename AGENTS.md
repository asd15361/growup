# AGENTS 必看规则（项目内固定）

本文件优先级：高。进入本仓库后必须先读，再执行任务。

## 用户协作原则
- 用户是代码小白、低开发经验项目经理。
- 解释用大白话，不要纯技术术语输出。
- 默认 AI 自己执行任务，不把命令甩给用户跑。
- 用户只负责登录、验证码、最终验收。
- 不要让用户开第二个终端跑命令；AI 自己完成并说明哪个窗口可关。
- 能用 MCP 代办的网站操作必须代办，不要让用户手动点（除登录/验证码/验收）。

## 执行流程（强制）
1. 先提问澄清需求，不要直接改。  
2. 用户确认后，先做需求存档。  
3. 再执行开发/部署/验证。  
4. 最后给详细汇报（做了什么、为什么、结果、下一步）。  
5. 每次执行前先做根因分析，再给高颗粒度落地计划。  
6. 每次执行后必须写 worklog。  
7. 汇报时不用“已执行”，要写：当初任务是什么、是否解决、怎么解决。

## 手机 App 规则
- 默认本地打包 APK，不走模拟器/Expo 作为最终交付。
- 每次打包必须递增版本，且全链路一致（配置、显示、文件名）。
- APK 默认输出到桌面（`C:\Users\Administrator\Desktop\`）。
- 打包后记录本次版本与下次版本。
- 每次打包后自动写入 `docs/release-log.md`（版本、产物路径、时间、下次版本）。
- 图标统一改全套，不用默认图标；先问偏好。
- 当前默认图标偏好：黑白橙，黑底橙形。
- 版本号必须在安装包名、应用显示、配置里保持一致。
- 例如本次 `1.0.9`，下次必须推进到 `1.1.0` 并记录。

## MCP 操作规则
- 网站控制台操作优先用 MCP 自己完成。
- 能代办就代办，不让用户手动点页面。
- Chrome DevTools MCP 可用时优先用于控制台配置动作。
- 需要用户参与的仅限登录、验证码、最终验收。

## MCP/Skill 基线
- 优先具备并使用：`chrome-devtools-mcp`。
- 优先具备并使用：`ui-ux-pro-max-skill`（UI 任务）。
- 优先具备并使用：Vercel / Git 相关 MCP（发布与仓库管理）。

## PocketBase 强制规范
- 使用统一实例 + `users` 认证集合。
- 业务数据强制 `appId` + `user` 关联 + 角色权限层。
- 禁止空规则；新增集合必须含字段/索引/规则/验证步骤。
- 必须有 `user_apps`，并有唯一索引 `(user, appId)`。
- 业务表必须有审计字段：`createdBy`, `updatedBy`, `created`, `updated`。
- `appId` 必须白名单化。
- 设计要支持按 `appId` 独立迁移。

## 安全规则
- 禁止把真实账号密码提交仓库，只允许本地 `.env`。
- 禁止修改 superuser 凭据，除非有明确变更单。
- 涉及账号、密码、权限、支付、生产配置：先报备再改，并记录变更。
- 禁止私自改任何密码/凭证；改动必须留记录，避免团队失联。

## 根因修复原则（强制）
- 出问题先找源头，不做“盖住报错”的表面修补。
- 每次修复必须回答：根因是什么、为何出现、如何从底层防复发。
- 不追求最快方案，优先长期稳定可复用的方案。

## 文档与范围
- 规则文档主目录在 `C:\Users\Administrator\`，所有项目都要遵守。
- 项目内同步规则：`docs/collaboration-release-rules.md`、`docs/worklog-*.md`。

## 详细规范文档
- 详见：`docs/collaboration-release-rules.md`
